"use strict";(self.webpackChunkics=self.webpackChunkics||[]).push([[85],{7647:(C,T,n)=>{n.d(T,{Y:()=>A});var s=n(1292),c=n(9863),e=n(3668),f=n(6019),E=n(5093),h=n(2450);function P(m,U){if(1&m&&(e.ynx(0),e.TgZ(1,"small"),e._uU(2),e.qZA(),e.BQk()),2&m){const p=e.oxw();e.xp6(2),e.hij(" - ",p.formule.kidAge,"")}}function t(m,U){if(1&m&&(e.TgZ(0,"span",11),e.TgZ(1,"span",12),e._uU(2),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.qZA(),e.qZA()),2&m){const p=U.$implicit;e.xp6(2),e.hij("",p.day,": "),e.xp6(2),e.Oqu(p.time)}}function _(m,U){1&m&&(e.TgZ(0,"p",13),e.TgZ(1,"mat-icon",14),e._uU(2,"check"),e.qZA(),e._uU(3," Cours en pr\xe9sentiel "),e.qZA())}function r(m,U){1&m&&(e.TgZ(0,"p",13),e.TgZ(1,"mat-icon",14),e._uU(2,"check"),e.qZA(),e._uU(3," Acc\xe8s illimit\xe9 au contenu en ligne "),e.qZA())}function u(m,U){1&m&&(e.TgZ(0,"p",13),e.TgZ(1,"mat-icon",14),e._uU(2,"check"),e.qZA(),e._uU(3," Passage de grade "),e.qZA())}let A=(()=>{class m{constructor(p,g){this.dialogRef=p,this.data=g,this.ageGroup=c.y,this.CANCEL="cancel",this.formule=g}onCancel(){this.dialogRef.close({action:this.CANCEL})}}return m.\u0275fac=function(p){return new(p||m)(e.Y36(s.so),e.Y36(s.WI))},m.\u0275cmp=e.Xpm({type:m,selectors:[["dialog-formule-details"]],decls:24,vars:9,consts:[["matDialogTitle",""],[1,"title"],[1,"color-primary-font"],[4,"ngIf"],[1,"dialog__content"],[1,"display-flex","flex-column"],[1,"display-flex","flex-column","schedules__container"],["class","display-flex",4,"ngFor","ngForOf"],["class","display-flex align-center",4,"ngIf"],["align","end"],["mat-raised-button","","color","accent","type","button",3,"click"],[1,"display-flex"],[1,"color-primary-font","bold","schedules__day"],[1,"display-flex","align-center"],["color","primary"]],template:function(p,g){1&p&&(e.TgZ(0,"div",0),e.TgZ(1,"h2",1),e.TgZ(2,"strong",2),e._uU(3),e.qZA(),e._uU(4),e.YNc(5,P,3,1,"ng-container",3),e.qZA(),e.qZA(),e.TgZ(6,"mat-dialog-content",4),e.TgZ(7,"p",5),e.TgZ(8,"strong"),e._uU(9,"Lieu:"),e.qZA(),e.TgZ(10,"span"),e._uU(11),e.qZA(),e.TgZ(12,"span"),e._uU(13),e.qZA(),e.qZA(),e.TgZ(14,"p",6),e.TgZ(15,"strong"),e._uU(16,"Horaires:"),e.qZA(),e.YNc(17,t,5,2,"span",7),e.qZA(),e.YNc(18,_,4,0,"p",8),e.YNc(19,r,4,0,"p",8),e.YNc(20,u,4,0,"p",8),e.qZA(),e.TgZ(21,"mat-dialog-actions",9),e.TgZ(22,"button",10),e.NdJ("click",function(){return g.onCancel()}),e._uU(23," Fermer "),e.qZA(),e.qZA()),2&p&&(e.xp6(3),e.Oqu(g.formule.title),e.xp6(1),e.hij(" - ",g.formule.ageGroup," "),e.xp6(1),e.Q6J("ngIf",g.formule.ageGroup===g.ageGroup.KIDS),e.xp6(6),e.Oqu(g.formule.location),e.xp6(2),e.Oqu(g.formule.street),e.xp6(4),e.Q6J("ngForOf",g.formule.schedules),e.xp6(1),e.Q6J("ngIf",g.formule.physicalClass),e.xp6(1),e.Q6J("ngIf",g.formule.onlineAccess),e.xp6(1),e.Q6J("ngIf",g.formule.graduation))},directives:[s.uh,f.O5,s.xY,f.sg,s.H8,E.lW,h.Hw],styles:[".dialog__content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:1rem auto}.dialog__content[_ngcontent-%COMP%]   .schedules__day[_ngcontent-%COMP%]{padding:0 .5rem 0 0}"]}),m})()},9863:(C,T,n)=>{n.d(T,{y:()=>s});var s=(()=>{return(c=s||(s={})).KIDS="Enfants",c.TEENS="Adolescents",c.ADULTS="Adultes",s;var c})()},5805:(C,T,n)=>{n.d(T,{d:()=>s});var s=(()=>{return(c=s||(s={})).CARD="card",c.OTHER="other",c.MULTIPLE="multiple",s;var c})()},9542:(C,T,n)=>{n.d(T,{p:()=>h});var s=n(6556),c=n(8053),e=n(8260),f=n(3668),E=n(4522);let h=(()=>{class P{constructor(_){this.http=_,this._API_URL=e.N.apiUrl,this._FORMULE_URL=`${this._API_URL}/formule`,this._FORMULE_URL_USER_MODE=`${this._API_URL}/formule-user-mode`,this._FORMULES_URL=`${this._API_URL}/formules`}addFormule(_){return console.log("data",_),this.http.post(`${this._FORMULE_URL}`,_)}updateFormule(_){return console.log("data",_),this.http.put(`${this._FORMULE_URL}/${_._id}`,_)}getFormules(_){return this.http.get(`${this._FORMULES_URL}/${_}`).pipe((0,s.d)(),(0,c.U)(r=>r.formules))}getFormule(_){return this.http.get(`${this._FORMULE_URL}/${_}`).pipe((0,s.d)(),(0,c.U)(r=>r.formule))}getFormuleUserMode(_){return this.http.get(`${this._FORMULE_URL_USER_MODE}/${_}`).pipe((0,s.d)(),(0,c.U)(r=>r.formule))}deleteFormule(_){return console.log("delete formule",_),this.http.delete(`${this._FORMULE_URL}/${_._id}`)}}return P.\u0275fac=function(_){return new(_||P)(f.LFG(E.eN))},P.\u0275prov=f.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})()},6776:(C,T,n)=>{n.d(T,{F:()=>P});var s=n(8260),c=n(8053),e=n(5722),f=n(3668),E=n(4522),h=n(4382);let P=(()=>{class t{constructor(r,u){this.http=r,this.router=u,this.NURSERY_SUBSCRIPTION_URL=s.N.apiUrl+"/subscription/nursery",this.ELEMENTARY_SUBSCRIPTION_URL=s.N.apiUrl+"/subscription/elementary",this.KID_SUBSCRIPTION_URL=s.N.apiUrl+"/subscription/kid",this.ADULT_SUBSCRIPTION_URL=s.N.apiUrl+"/subscription/adult",this.SUBSCRIPTION_CREDIT_CARD_URL=s.N.apiUrl+"/subscription/credit-card",this.PAYMENT_CREDIT_CARD_URL=s.N.apiUrl+"/subscription/payment-credit-card",this.SUBSCRIPTION_OTHER_PAYMENT_URL=s.N.apiUrl+"/subscription/other",this.EMAIL_URL=s.N.apiUrl+"/subscription/email",this.COUPON_URL=s.N.apiUrl+"/subscription/coupon"}sendKidsForm(r){let u;return 0===r.ageGroup?u=this.NURSERY_SUBSCRIPTION_URL:1===r.ageGroup&&(u=this.ELEMENTARY_SUBSCRIPTION_URL),this.http.post(`${u}`,r)}sendAdultForm(r){return this.http.post(this.ADULT_SUBSCRIPTION_URL,r)}validateSubscriptionOtherPayment(r){return this.http.post(this.SUBSCRIPTION_OTHER_PAYMENT_URL,r)}validateSubscriptionCardPayment(r){return this.http.post(this.SUBSCRIPTION_CREDIT_CARD_URL,r)}makeCardPayment(r){return console.log(r),this.http.post(this.PAYMENT_CREDIT_CARD_URL,r)}getKid(r){return this.http.get(`${this.KID_SUBSCRIPTION_URL}/${r}`).pipe((0,c.U)(u=>u.data))}getAdult(r){return this.http.get(`${this.ADULT_SUBSCRIPTION_URL}/${r}`).pipe((0,c.U)(u=>u.data))}getKidData(){return this.http.get(`${this.KID_SUBSCRIPTION_URL}`).pipe((0,c.U)(r=>r.data))}getAdultData(){return this.http.get(`${this.ADULT_SUBSCRIPTION_URL}`).pipe((0,c.U)(r=>r.data))}updateKid(r){return this.http.put(`${this.KID_SUBSCRIPTION_URL}/${r._id}`,r).pipe((0,e.b)(u=>console.log(u.message)))}updateAdult(r){return this.http.put(`${this.ADULT_SUBSCRIPTION_URL}/${r._id}`,r).pipe((0,e.b)(u=>console.log(u.message)))}deleteKid(r){return this.http.delete(`${this.KID_SUBSCRIPTION_URL}/${r}`).pipe((0,e.b)(u=>console.log(u.message)))}deleteAdult(r){return this.http.delete(`${this.ADULT_SUBSCRIPTION_URL}/${r}`).pipe((0,e.b)(u=>console.log(u.message)))}validateCoupon(r,u){return this.http.post(this.COUPON_URL,{couponInput:r,formuleId:u})}checkEmail(r){return this.http.post(this.EMAIL_URL,{email:r})}}return t.\u0275fac=function(r){return new(r||t)(f.LFG(E.eN),f.LFG(h.F0))},t.\u0275prov=f.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},1085:(C,T,n)=>{n.r(T),n.d(T,{ProfileViewModule:()=>it});var s=n(6019),c=n(9133),e=n(82),f=n(4382),E=n(4762),h=n(1292),P=n(6658),t=n(3668),_=n(9171),r=n(3855),u=n(6031),A=n(4275),I=n(5093);function m(o,l){1&o&&t._UZ(0,"mat-spinner",6)}function U(o,l){1&o&&(t.TgZ(0,"p",7),t._uU(1," Les informations n'ont pas pu \xeatre charg\xe9es "),t.qZA())}function p(o,l){1&o&&(t.TgZ(0,"mat-error"),t._uU(1,"Veuillez renseigner votre pr\xe9nom"),t.qZA())}function g(o,l){1&o&&(t.TgZ(0,"mat-error"),t._uU(1,"Veuillez renseigner votre nom"),t.qZA())}function D(o,l){if(1&o){const i=t.EpF();t.TgZ(0,"form",8),t.NdJ("ngSubmit",function(){return t.CHM(i),t.oxw().onSubmit()}),t.TgZ(1,"mat-form-field"),t.TgZ(2,"mat-label"),t._uU(3,"Pr\xe9nom"),t.qZA(),t._UZ(4,"input",9),t.YNc(5,p,2,0,"mat-error",10),t.qZA(),t.TgZ(6,"mat-form-field"),t.TgZ(7,"mat-label"),t._uU(8,"Nom"),t.qZA(),t._UZ(9,"input",11),t.YNc(10,g,2,0,"mat-error",10),t.qZA(),t.qZA()}if(2&o){const i=t.oxw();t.Q6J("formGroup",i.editProfileForm),t.xp6(5),t.Q6J("ngIf",i.editProfileForm.get("firstName").invalid&&i.editProfileForm.touched),t.xp6(5),t.Q6J("ngIf",i.editProfileForm.get("lastName").invalid&&i.editProfileForm.touched)}}const R=function(o,l,i){return{user:o,imagePreview:l,action:i}};function L(o,l){if(1&o){const i=t.EpF();t.TgZ(0,"div",12),t.TgZ(1,"button",13),t.NdJ("click",function(){return t.CHM(i),t.oxw().onCancel()}),t._uU(2,"Annuler"),t.qZA(),t.TgZ(3,"button",14),t.NdJ("click",function(){return t.CHM(i),t.oxw().onSubmit()}),t._uU(4," Modifier "),t.qZA(),t.qZA()}if(2&o){const i=t.oxw();t.xp6(3),t.Q6J("mat-dialog-close",t.kEZ(2,R,i.user,i.imagePreview,i.CONFIRM))("disabled",i.editProfileForm.invalid)}}let N=(()=>{class o{constructor(i,a,d,Z){this.authService=i,this.dialogRef=a,this.data=d,this.dialog=Z,this.editProfileForm=new c.cw({}),this.isLoading=!1,this.userError=!1,this.imageEdited=!1,this.CONFIRM="confirm",this.CANCEL="cancel",this.userId=d,this.dialogRef.disableClose=!0}ngOnInit(){this.isLoading=!0,this._getUserData()}onSubmit(){this.editProfileForm.invalid||(this.user.firstName=this.editProfileForm.get("firstName").value.trim(),this.user.lastName=this.editProfileForm.get("lastName").value.trim(),(null===this.user.profileImagePath||this.imageEdited)&&(this.user.profileImagePath=this.editProfileForm.get("image").value))}onImagepicked(i){const a=i.target.files[0];this.editProfileForm.patchValue({image:a}),this.editProfileForm.get("image").updateValueAndValidity();const d=new FileReader;this.imageEdited=!0,d.onload=()=>{this.imagePreview=d.result},d.readAsDataURL(a)}onCancel(){this.dialogRef.close({user:this.user,imagePreview:this.imagePreview,action:this.CANCEL})}_getUserData(){this.authService.getUser(this.userId).pipe((0,P.x)(()=>this.isLoading=!1)).subscribe(i=>{this.user=i.user,this.imagePreview=this.user.profileImagePath,this._initEditProfileForm(i.user)},i=>{this.userError=!0})}_initEditProfileForm(i){this.editProfileForm.addControl("lastName",new c.NI(i.lastName,c.kI.required)),this.editProfileForm.addControl("firstName",new c.NI(i.firstName,c.kI.required))}}return o.\u0275fac=function(i){return new(i||o)(t.Y36(_.e),t.Y36(h.so),t.Y36(h.WI),t.Y36(h.uw))},o.\u0275cmp=t.Xpm({type:o,selectors:[["edit-profile-dialog"]],decls:7,vars:4,consts:[["mat-dialog-title",""],[1,"profile-form__container"],["class","spinner","color","accent","diameter","50",4,"ngIf"],["class","error-message",4,"ngIf"],["class","profile-edition-form",3,"formGroup","ngSubmit",4,"ngIf"],["mat-dialog-actions","","align","end",4,"ngIf"],["color","accent","diameter","50",1,"spinner"],[1,"error-message"],[1,"profile-edition-form",3,"formGroup","ngSubmit"],["matInput","","type","text","name","firstName","formControlName","firstName","required",""],[4,"ngIf"],["matInput","","type","text","name","lastName","formControlName","lastName","required",""],["mat-dialog-actions","","align","end"],["mat-button","","color","warn",3,"click"],["mat-flat-button","","color","primary",3,"mat-dialog-close","disabled","click"]],template:function(i,a){1&i&&(t.TgZ(0,"h2",0),t._uU(1,"Modification de mes informations"),t.qZA(),t.TgZ(2,"section",1),t.YNc(3,m,1,0,"mat-spinner",2),t.YNc(4,U,2,0,"p",3),t.YNc(5,D,11,3,"form",4),t.qZA(),t.YNc(6,L,5,6,"div",5)),2&i&&(t.xp6(3),t.Q6J("ngIf",a.isLoading),t.xp6(1),t.Q6J("ngIf",!a.isLoading&&a.userError),t.xp6(1),t.Q6J("ngIf",!a.isLoading&&!a.userError),t.xp6(1),t.Q6J("ngIf",!a.isLoading))},directives:[h.uh,s.O5,r.$g,c._Y,c.JL,c.sg,u.KE,u.hX,A.Nt,c.Fj,c.JJ,c.u,c.Q7,u.TO,h.H8,I.lW,h.ZT],styles:[".spinner[_ngcontent-%COMP%]{margin:auto}.profile-edition-form[_ngcontent-%COMP%]{display:flex;flex-flow:column}input[type=file][_ngcontent-%COMP%]{visibility:hidden;width:0}.profile-image__container[_ngcontent-%COMP%]{display:flex;flex-flow:column;justify-content:center;align-items:center}.image-preview[_ngcontent-%COMP%]{width:100px;height:100px;margin:0 auto 1rem;border-radius:100px;border:5px solid #393185;overflow:hidden}.image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:cover;object-fit:cover}.image-preview[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:100%;height:100%;display:block;font-size:90px}"]}),o})();var y=n(5805),F=n(7647),b=n(6776),S=n(7041),w=n(9542),O=n(5038),v=n(1893),Y=n(3475),M=n(5949);const q=["creditCardElement"];function B(o,l){1&o&&t._UZ(0,"mat-spinner",9)}function J(o,l){1&o&&(t.TgZ(0,"p",10),t._uU(1," Les informations n'ont pas pu \xeatre charg\xe9es "),t.qZA())}function V(o,l){if(1&o){const i=t.EpF();t.TgZ(0,"div",11),t.TgZ(1,"mat-button-toggle-group",12),t.NdJ("change",function(d){return t.CHM(i),t.oxw().onToggle(d)}),t.TgZ(2,"mat-button-toggle",13),t._uU(3,"Infos"),t.qZA(),t.TgZ(4,"mat-button-toggle",14),t._uU(5,"Inscriptions"),t.qZA(),t.qZA(),t.qZA()}}function j(o,l){if(1&o){const i=t.EpF();t.TgZ(0,"mat-card",15),t.TgZ(1,"p",16),t.TgZ(2,"span",17),t._uU(3," Pr\xe9nom "),t.qZA(),t._uU(4),t.qZA(),t.TgZ(5,"p",16),t.TgZ(6,"span",17),t._uU(7," Nom "),t.qZA(),t._uU(8),t.qZA(),t.TgZ(9,"p",16),t.TgZ(10,"span",17),t._uU(11," Email "),t.qZA(),t._uU(12),t.qZA(),t.TgZ(13,"mat-card-actions"),t.TgZ(14,"atom-button",18),t.NdJ("click",function(){t.CHM(i);const d=t.oxw();return d.onOpenEditDialog(d.user)}),t.qZA(),t.qZA(),t.qZA()}if(2&o){const i=t.oxw();t.xp6(4),t.hij(" ",i.user.firstName," "),t.xp6(4),t.hij(" ",i.user.lastName," "),t.xp6(4),t.hij("",i.user.email," "),t.xp6(2),t.Q6J("type","button")("text","Modifier mes informations")}}function $(o,l){if(1&o){const i=t.EpF();t.TgZ(0,"mat-expansion-panel"),t.TgZ(1,"mat-expansion-panel-header"),t.TgZ(2,"mat-panel-title"),t._uU(3),t.qZA(),t.qZA(),t.TgZ(4,"div",23),t.TgZ(5,"p",16),t.TgZ(6,"span",17),t._uU(7,"Formule :"),t.qZA(),t._uU(8),t.qZA(),t.TgZ(9,"p",16),t.TgZ(10,"span",17),t._uU(11,"Groupe d'\xe2ge :"),t.qZA(),t._uU(12),t.qZA(),t.TgZ(13,"p",16),t.TgZ(14,"span",17),t._uU(15,"Pr\xe9nom :"),t.qZA(),t._uU(16),t.qZA(),t.TgZ(17,"p",16),t.TgZ(18,"span",17),t._uU(19,"Nom :"),t.qZA(),t._uU(20),t.qZA(),t.TgZ(21,"div",24),t.TgZ(22,"button",25),t.NdJ("click",function(){const Z=t.CHM(i).$implicit;return t.oxw(2).onDisplayDetails(Z.formuleId)}),t._uU(23," D\xe9tails de la formule "),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const i=l.$implicit;t.xp6(3),t.AsE(" ",i.firstName," ",i.lastName," "),t.xp6(5),t.hij(" ",i.formuleTitle," "),t.xp6(4),t.hij(" ",i.formuleAgeGroup," "),t.xp6(4),t.hij(" ",i.firstName," "),t.xp6(4),t.hij(" ",i.lastName," ")}}function Q(o,l){1&o&&(t.TgZ(0,"mat-card-title"),t.TgZ(1,"p",26),t._uU(2,"Paiement en attente"),t.qZA(),t.qZA())}function K(o,l){1&o&&t._UZ(0,"mat-spinner",35)}function W(o,l){if(1&o){const i=t.EpF();t.TgZ(0,"button",36),t.NdJ("click",function(){return t.CHM(i),t.oxw(4).onCardPayment()}),t._uU(1),t.ALo(2,"currency"),t.qZA()}if(2&o){const i=t.oxw(4);t.Q6J("disabled",0===i.user.totalPrice||!i.isCardValid),t.xp6(1),t.AsE(" ",i.PAY_BUTTON_TEXT," ",t.lcZ(2,3,i.user.totalPrice)," ")}}function H(o,l){if(1&o&&(t.TgZ(0,"mat-card-content"),t.TgZ(1,"p",27),t._uU(2," Votre inscription sera valid\xe9e d\xe8s le paiement effectu\xe9 "),t.qZA(),t.TgZ(3,"p",28),t._uU(4," Veuillez remplir les informations de votre carte "),t.qZA(),t._UZ(5,"div",29,30),t.TgZ(7,"p",31),t._uU(8),t.qZA(),t.TgZ(9,"div",32),t.YNc(10,K,1,0,"mat-spinner",33),t.YNc(11,W,3,5,"button",34),t.qZA(),t.qZA()),2&o){const i=t.oxw(3);t.xp6(8),t.Oqu(i.cardErrors),t.xp6(2),t.Q6J("ngIf",i.paymentLoading),t.xp6(1),t.Q6J("ngIf",!i.paymentLoading)}}function G(o,l){if(1&o&&(t.TgZ(0,"mat-card-content"),t.TgZ(1,"h2",37),t._uU(2," Paiement valid\xe9! "),t._UZ(3,"br"),t._uU(4," Merci, un email vient d'\xeatre envoy\xe9 \xe0 "),t._UZ(5,"br"),t.TgZ(6,"span",38),t._uU(7),t.qZA(),t.qZA(),t.qZA()),2&o){const i=t.oxw(3);t.xp6(7),t.hij(" ",i.user.email," ")}}function z(o,l){if(1&o&&(t.TgZ(0,"mat-card"),t.YNc(1,Q,3,0,"mat-card-title",22),t.YNc(2,H,12,3,"mat-card-content",22),t.YNc(3,G,8,1,"mat-card-content",22),t.qZA()),2&o){const i=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!i.showCardPaymentValidation),t.xp6(1),t.Q6J("ngIf",!i.showCardPaymentValidation),t.xp6(1),t.Q6J("ngIf",!i.paymentLoading&&i.showCardPaymentValidation)}}function k(o,l){if(1&o&&(t.TgZ(0,"div",19),t.YNc(1,$,24,6,"mat-expansion-panel",20),t.TgZ(2,"p",21),t._uU(3),t.ALo(4,"currency"),t.qZA(),t.YNc(5,z,4,3,"mat-card",22),t.qZA()),2&o){const i=t.oxw();t.xp6(1),t.Q6J("ngForOf",i.user.subscriptionAssociated),t.xp6(2),t.hij(" Montant: ",t.lcZ(4,3,i.user.totalPrice)," "),t.xp6(2),t.Q6J("ngIf",!i.user.paymentMade)}}const X=[{path:"",component:(()=>{class o{constructor(i,a,d,Z,x,ot){this.route=i,this.authService=a,this.subscriptionService=d,this._snackBar=Z,this.formuleService=x,this.dialog=ot,this.isLoading=!1,this.userError=!1,this.displayInfoContainer=!0,this.paymentLoading=!1,this.showCardPaymentValidation=!1,this.isCardValid=!1,this.FRENCH_CARD_NUMBER=0xe35fb281cf903,this.DECLINED_PAYMENT_CARD_NUMBER=0xe35fa931a270b,this.CONFIRM="confirm",this.CANCEL="cancel",this.PAY_BUTTON_TEXT="R\xe9gler"}ngOnInit(){this._getUser()}onCardPayment(){return(0,E.mG)(this,void 0,void 0,function*(){this.paymentLoading=!0;const i=yield this.stripe.createToken(this.creditCardContainer),a={user:this.user,token:i.token,paymentMethod:y.d.CARD};i.error?(this.paymentLoading=!1,this.cardErrors=i.error.message):(console.log("payment validated"),this.subscriptionService.makeCardPayment(a).pipe((0,P.x)(()=>{this.paymentLoading=!1})).subscribe(d=>{console.log(d),this.showCardPaymentValidation=!0},d=>{console.log("sub error",d.error.message),this._snackBar.open("Une erreur est survenue, veuillez r\xe9essayer"),setTimeout(()=>{this._initStripe()},2e3)}))})}onToggle(i){console.log(i),this.displayInfoContainer="info"===i.value,!this.displayInfoContainer&&!this.user.paymentMade&&setTimeout(()=>{this._initStripe()},500)}onDisplayDetails(i){console.log(i),this.formuleService.getFormuleUserMode(i).subscribe(a=>{console.log(a),this.dialog.open(F.Y,{minWidth:"320px",data:a}).beforeClosed().subscribe()})}onOpenEditDialog(i){this.dialog.open(N,{minWidth:"300px",data:i._id}).beforeClosed().subscribe(Z=>{this.user=Z.user,this.isLoading=!0,Z.action===this.CONFIRM?this.authService.updateUser({_id:this.userId,firstName:this.user.firstName,lastName:this.user.lastName}).subscribe(x=>{this.user.profileImagePath=Z.imagePreview,this.authService.userDataListener$.next(this.user),this.isLoading=!1},x=>{this.isLoading=!1}):this.isLoading=!1})}_initStripe(){this.stripe=Stripe("pk_live_51Iv78DInlL2kaZj1snSdVBtKW8YD4LWQU4m2MHONj5S6mRHGg4rTQ2Hq8l6eH2PGI6OeFWzFeGJShTl1XLDV7zc400j47Y0wE9");const i=this.stripe.elements({locale:"fr"});this.creditCardContainer=i.create("card"),this.creditCardContainer.mount(this.creditCardElement.nativeElement),this.creditCardContainer.addEventListener("change",a=>{console.log("callback",a),this.cardErrors=a.error&&a.error.message,this.isCardValid=a.complete})}_getUser(){this.isLoading=!0,this.route.params.subscribe(i=>{this.userId=i.userId,this.authService.getUser(this.userId).subscribe(a=>{this.user=a.user,this.isLoading=!1},a=>{console.log(a),this.userError=!0,this.isLoading=!1})})}}return o.\u0275fac=function(i){return new(i||o)(t.Y36(f.gz),t.Y36(_.e),t.Y36(b.F),t.Y36(S.ux),t.Y36(w.p),t.Y36(h.uw))},o.\u0275cmp=t.Xpm({type:o,selectors:[["profile"]],viewQuery:function(i,a){if(1&i&&t.Gf(q,5),2&i){let d;t.iGM(d=t.CRH())&&(a.creditCardElement=d.first)}},decls:11,vars:8,consts:[[1,"main"],[1,"profile-header"],[1,"title-md"],[1,"profile__container"],["class","spinner","color","accent","diameter","50",4,"ngIf"],["class","error-message",4,"ngIf"],["class","display-flex justify-center margin-bottom-1",4,"ngIf"],["class","card",4,"ngIf"],["class","subscription__container",4,"ngIf"],["color","accent","diameter","50",1,"spinner"],[1,"error-message"],[1,"display-flex","justify-center","margin-bottom-1"],["name","fontStyle","aria-label","Font Style",3,"change"],["checked","","value","info"],["value","subscription"],[1,"card"],[1,"profile__info"],[1,"bold","font-size-sm"],[1,"btn",3,"type","text","click"],[1,"subscription__container"],[4,"ngFor","ngForOf"],[1,"margin-y-1","text-center"],[4,"ngIf"],[1,"expansion-panel__content"],[1,"btn__container"],["mat-raised-button","","color","accent","type","button",1,"btn",3,"click"],[1,"warning","text-center"],[1,"text-center","margin-top-1"],[1,"color-primary-font","text-center","bold","margin-top-1"],[1,"credit-card__input"],["creditCardElement",""],[1,"credit-card__error"],[1,"btn__container","btn__container--block","btn__container--submit"],["color","accent","diameter","50",4,"ngIf"],["mat-raised-button","","type","submit","color","primary",3,"disabled","click",4,"ngIf"],["color","accent","diameter","50"],["mat-raised-button","","type","submit","color","primary",3,"disabled","click"],[1,"margin-bottom-1","text-center"],[1,"color-primary-font"]],template:function(i,a){1&i&&(t.TgZ(0,"main",0),t.TgZ(1,"section",1),t.TgZ(2,"p",2),t._uU(3),t.ALo(4,"uppercase"),t.qZA(),t.qZA(),t.TgZ(5,"section",3),t.YNc(6,B,1,0,"mat-spinner",4),t.YNc(7,J,2,0,"p",5),t.YNc(8,V,6,0,"div",6),t.YNc(9,j,15,5,"mat-card",7),t.YNc(10,k,6,5,"div",8),t.qZA(),t.qZA()),2&i&&(t.xp6(3),t.hij(" ",t.lcZ(4,6,"Mon Profil")," "),t.xp6(3),t.Q6J("ngIf",a.isLoading),t.xp6(1),t.Q6J("ngIf",!a.isLoading&&a.userError),t.xp6(1),t.Q6J("ngIf",!a.isLoading),t.xp6(1),t.Q6J("ngIf",!a.isLoading&&!a.userError&&a.displayInfoContainer),t.xp6(1),t.Q6J("ngIf",!a.isLoading&&!a.userError&&!a.displayInfoContainer))},directives:[s.O5,r.$g,O.A9,O.Yi,v.a8,v.hq,Y.r,s.sg,M.ib,M.yz,M.yK,I.lW,v.n5,v.dn],pipes:[s.gd,s.H9],styles:["[_nghost-%COMP%]{min-height:calc(100% - 174px);display:flex;flex-flow:column}.main[_ngcontent-%COMP%]{flex:1;background:#ffffff}.profile-header[_ngcontent-%COMP%]{padding:1rem}.profile-header__content[_ngcontent-%COMP%]{text-align:center;margin:2rem 0}.spinner[_ngcontent-%COMP%]{margin:auto}.mat-button-toggle-checked[_ngcontent-%COMP%]{background:#393185;color:#fff}.card[_ngcontent-%COMP%]{width:320px;margin:0 auto}.card[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{display:block;margin:0 auto}.profile-image__container[_ngcontent-%COMP%]{width:100px;height:100px;margin:0 auto 1rem;border-radius:100px;border:5px solid #393185;overflow:hidden}.profile-image__container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:cover;object-fit:cover}.profile-image__container[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:100%;height:100%;display:block;font-size:90px}.profile__info[_ngcontent-%COMP%]{display:flex;flex-flow:column;margin:0 0 1rem}.error-message[_ngcontent-%COMP%]{margin:0 auto 1rem}.subscription__container[_ngcontent-%COMP%]{margin:0 auto;max-width:500px}.subscription__container[_ngcontent-%COMP%]   .expansion-panel__content[_ngcontent-%COMP%]{padding:1rem}.credit-card__input[_ngcontent-%COMP%]{width:300px;margin:1rem auto;border:1px solid #393185;border-radius:4px;padding:1rem}.credit-card__error[_ngcontent-%COMP%]{width:300px;color:#f44336;font-size:.8rem;margin:0 auto}.btn__container[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;margin:1rem auto;width:320px}"]}),o})()}];let tt=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[f.Bz.forChild(X)],f.Bz]}),o})();var et=n(1382);let it=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({providers:[],imports:[[s.ez,tt,et.m,e.q,c.UX]]}),o})()}}]);