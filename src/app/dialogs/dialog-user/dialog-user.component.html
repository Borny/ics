<h2 class="title">
  {{ DIALOG_TITLE }}
  <strong *ngIf="!loading" class="color-primary-font">
    {{ user.firstName }} {{ user.lastName }}
  </strong>
</h2>

<mat-dialog-content>
  <atom-spinner
    *ngIf="loading"
    [color]="'accent'"
    class="spinner"
  ></atom-spinner>

  <form
    *ngIf="(user$ | async) && !loading"
    class="form"
    [formGroup]="userForm"
    (ngSubmit)="onSubmit()"
  >
    <div class="form__group">
      <mat-form-field>
        <mat-label>Prénom</mat-label>
        <input
          matInput
          type="text"
          name="firstName"
          formControlName="firstName"
          required
        />
        <mat-error
          *ngIf="
            userForm.get('firstName').invalid &&
            userForm.get('firstName').touched
          "
          >Veuillez renseigner le prénom</mat-error
        >
      </mat-form-field>
      <mat-form-field>
        <mat-label>Nom</mat-label>
        <input
          matInput
          type="text"
          name="lastName"
          formControlName="lastName"
          required
        />
        <mat-error
          *ngIf="
            userForm.get('lastName').invalid && userForm.get('lastName').touched
          "
          >Veuillez renseigner le nom</mat-error
        >
      </mat-form-field>
      <mat-form-field>
        <mat-label>E-mail</mat-label>
        <input
          matInput
          type="email"
          name="email"
          formControlName="email"
          required
        />
      </mat-form-field>
      <mat-form-field>
        <mat-label>Date d'inscription</mat-label>
        <input
          matInput
          type="text"
          name="signUpDate"
          formControlName="signUpDate"
          required
        />
      </mat-form-field>
      <div class="display-flex">
        <mat-label>Status du paiement: </mat-label>
        <mat-checkbox formControlName="paymentMade">{{
          userForm.get("paymentMade").value ? "OK" : "A régler"
        }}</mat-checkbox>
      </div>
      <p>
        Méthode de paiement :
        {{ user.paymentMethod === "card" ? "Carte" : "Autre" }}
      </p>
      <p class="color-primary-font margin-top-1">
        <strong>Inscriptions associées :</strong>
      </p>
      <div
        *ngFor="let formule of user.subscriptionAssociated; let idx = index"
        class="margin-bottom-1"
      >
        <p>
          <span class="color-primary-font">{{ idx + 1 }} - </span>
          <span class="color-primary-font">Formule :</span>
          {{ formule.formuleTitle }}
        </p>
        <p>
          <span class="color-primary-font">Prénom :</span>
          {{ formule.firstName }}
        </p>
        <p>
          <span class="color-primary-font">Nom :</span>
          {{ formule.lastName }}
        </p>
        <p>
          <span class="color-primary-font">Groupe d'âge :</span>
          {{ formule.formuleAgeGroup }}
        </p>
      </div>
    </div>
  </form>
</mat-dialog-content>
<div mat-dialog-actions align="end">
  <button mat-raised-button color="warn" type="button" (click)="onDeleteUser()">
    Supprimer
  </button>
  <button mat-raised-button color="accent" (click)="onCancel()" type="button">
    Annuler
  </button>
  <button
    mat-raised-button
    color="primary"
    (click)="onSubmit()"
    type="submit"
    [disabled]="userForm.invalid"
  >
    Modifier
  </button>
</div>
